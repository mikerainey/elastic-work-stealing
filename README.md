# Elastic work stealing

## Setup

In a new folder, e.g., `elastic`, clone the following repositories.

```
$ mkdir elastic
$ cd elastic
$ git clone git@github.com:mikerainey/elastic-work-stealing
$ git clone git@github.com:mikerainey/mcsl -b elastic
$ git clone git@github.com:mikerainey/pbbslib.git -b mcsl
$ git clone git@github.com:mikerainey/pbbsbench.git
$ git clone git@github.com:shwestrick/mini-uts.git
```

### Nix

Using nix, we can start working on benchmarks by switching the `cpp` folder
and loading the nix shell, as follows.


```
$ cd elastic-work-stealing/cpp
$ nix-shell
```

### Manual

TODO

```
$ git clone git@github.com:deepsea-inria/cmdline.git
```

## Building and running benchmarks

We can now build any of the available benchmarks in this folder. For
each benchmark, we can build one of four versions:

- `opt` is most optimized, and reports minimal stats
- `sta` reports stats
- `log` generates a log output and reports stats
- `dbg` is a debugging binary, with the capabilities of `log`, and minimal optimization and maximum debugging support

### Logging

We can use the logging binary to generate utilization plots, which
help us visualize the activity of the scheduler. The plotting data can
be generated by building a logging binary and running with the flag
`--pview`, which instructs the binary to output data to be used by our
visualization tool.

```
$ make fib.log
$ ./fib.log -n 35 -proc 8 --pview
```

Now, if successful, the run of `fib.log` should have created a new
file named `LOG_BIN` in the current directory. We can now run our
(x-windows) tool, which is installed automatically by the nix shell.

```
$ pview
```

